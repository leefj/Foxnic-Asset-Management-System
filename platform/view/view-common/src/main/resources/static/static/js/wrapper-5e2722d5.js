var V=Object.defineProperty,Y=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var E=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))Q.call(t,n)&&E(e,n,t[n]);if(k)for(var n of k(t))U.call(t,n)&&E(e,n,t[n]);return e},I=(e,t)=>Y(e,J(t));var m=(e,t,n)=>new Promise((o,i)=>{var p=r=>{try{d(n.next(r))}catch(l){i(l)}},_=r=>{try{d(n.throw(r))}catch(l){i(l)}},d=r=>r.done?o(r.value):Promise.resolve(r.value).then(p,_);d((n=n.apply(e,t)).next())});import{g as R}from"./storage-25d39754.js";import{d as g,o as c,c as u,s as D,am as v,u as a,an as O,al as f,ao as S,ap as P,aq as G,D as h,ar as q,as as B,E as M,F as N,h as w,Y as y,m as W,at as X,j as A,au as Z,av as ee,q as te,e as C,a2 as b,aw as T,w as oe,ax as ne,ay as $,az as re,S as ae}from"./index-c6cc3b14.js";import{u as se,f as ie,a as ce}from"./index-68969097.js";import{u as F}from"./useLifeHandler.hook-e225f7c9.js";import{u as x,C as le}from"./chartEditStore-3ee495ca.js";import"./SettingItem-ec2fd044.js";/* empty css                                                                       */import"./SettingItemBox-cf908047.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-81d1b4a3.js";import"./icon-8314374d.js";import"./index.esm.min-4d91f069.js";import"./http-abbaebe7.js";import"./lodash-c32566df.js";import"./plugin-0dcb0bd6.js";import"./fileTypeEnum-21359a08.js";const j=(e,t)=>({zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}),z=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),H=e=>({display:e.hide?"none":"block"}),K=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},ue=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return s({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)},pe=g({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(c(!0),u(N,null,D(e.groupData.groupList,o=>(c(),u("div",{class:v(["chart-item",a(O)(o.styles.animations)]),key:o.id,style:f(s(s(s(s(s(s({},a(j)(o.attr,e.groupIndex)),a(S)(o.styles)),a(P)(o.styles)),a(H)(o.status)),a(K)(o.preview)),a(G)(o.styles)))},[(c(),h(M(o.chartConfig.chartKey),q({id:o.id,chartConfig:o,themeSetting:e.themeSetting,themeColor:e.themeColor,style:s({},a(z)(o.attr))},B(a(F)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});const de=w(pe,[["__scopeId","data-v-214bf203"]]),_e=g({__name:"index",setup(e){const{initDataPond:t,clearMittDataPondMap:n}=se(),o=x(),i=y(()=>o.editCanvasConfig.chartThemeSetting),p=y(()=>X(o.editCanvasConfig.chartCustomThemeColorInfo)[o.editCanvasConfig.chartThemeColor]);return n(),W(()=>{t(o.requestGlobalConfig)}),(_,d)=>(c(!0),u(N,null,D(a(o).componentList,(r,l)=>(c(),u("div",{class:v(["chart-item",a(O)(r.styles.animations)]),key:r.id,style:f(s(s(s(s(s(s({},a(j)(r.attr,l)),a(S)(r.styles)),a(P)(r.styles)),a(H)(r.status)),a(K)(r.preview)),a(G)(r.styles)))},[r.isGroup?(c(),h(a(de),{key:0,groupData:r,groupIndex:l,themeSetting:i.value,themeColor:p.value},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(c(),h(M(r.chartConfig.chartKey),q({key:1,id:r.id,chartConfig:r,themeSetting:i.value,themeColor:p.value,style:s({},a(z)(r.attr))},B(a(F)(r))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});const L=w(_e,[["__scopeId","data-v-5807f851"]]),he=e=>{const t=A(!1),n=setInterval(()=>{if(window.$vue.component){clearInterval(n);const o=i=>{window.$vue.component(i.chartConfig.chartKey)||window.$vue.component(i.chartConfig.chartKey,ie(i.chartConfig))};e.componentList.forEach(i=>m(void 0,null,function*(){i.isGroup?i.groupList.forEach(p=>{o(p)}):o(i)})),t.value=!0}},200);return{show:t}},ge=e=>{const t=x();t.requestGlobalConfig=e[le.REQUEST_GLOBAL_CONFIG]},me=g({__name:"suspenseIndex",setup(e){return m(this,null,function*(){let t,n;[t,n]=Z(()=>R()),yield t,n();const o=x();ee(`预览-${o.editCanvasConfig.projectName}`);const i=y(()=>s(s({},ue(o.editCanvasConfig)),S(o.editCanvasConfig))),p=y(()=>{const l=o.editCanvasConfig.previewScaleType;return l===T.SCROLL_Y||l===T.SCROLL_X});ge(o);const{entityRef:_,previewRef:d}=ce(o),{show:r}=he(o);return(l,Ce)=>(c(),u("div",{class:v(`go-preview ${a(o).editCanvasConfig.previewScaleType}`)},[p.value?(c(),u("div",{key:0,ref_key:"entityRef",ref:_,class:"go-preview-entity"},[te("div",{ref_key:"previewRef",ref:d,class:"go-preview-scale"},[a(r)?(c(),u("div",{key:0,style:f(i.value)},[C(a(L))],4)):b("",!0)],512)],512)):(c(),u("div",{key:1,ref_key:"previewRef",ref:d,class:"go-preview-scale"},[a(r)?(c(),u("div",{key:0,style:f(i.value)},[C(a(L))],4)):b("",!0)],512))],2))})}});const fe=w(me,[["__scopeId","data-v-285e31bb"]]),ye=g({__name:"index",setup(e){return(t,n)=>(c(),h(ne,null,{default:oe(()=>[C(fe)]),_:1}))}}),qe=g({__name:"wrapper",setup(e){let t=A(Date.now());return[$.JSON,$.CHART_TO_PREVIEW].forEach(n=>{window.opener&&window.opener.addEventListener(n,o=>m(this,null,function*(){const i=yield R();re(ae.GO_CHART_STORAGE_LIST,[I(s({},o.detail),{id:i.id})]),t.value=Date.now()}))}),(n,o)=>(c(),h(ye,{key:a(t)}))}});export{qe as default};
