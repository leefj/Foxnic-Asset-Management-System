var V=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var E=(e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,s=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&E(e,n,t[n]);if(k)for(var n of k(t))W.call(t,n)&&E(e,n,t[n]);return e},I=(e,t)=>J(e,Q(t));var f=(e,t,n)=>new Promise((o,i)=>{var p=r=>{try{d(n.next(r))}catch(l){i(l)}},_=r=>{try{d(n.throw(r))}catch(l){i(l)}},d=r=>r.done?o(r.value):Promise.resolve(r.value).then(p,_);d((n=n.apply(e,t)).next())});import{g as R}from"./storage-1f406e49.js";import{d as g,o as c,c as u,s as D,ap as v,u as a,aq as O,ao as y,ar as S,as as G,at as P,E as h,au as q,av as B,G as A,F as M,j as w,a0 as m,n as X,aw as Y,l as N,ax as Z,ay as ee,q as te,e as C,a5 as T,az as $,w as oe,aA as ne,aB as b,aC as re,S as ae}from"./index-232a8936.js";import{u as se,f as ie,a as ce}from"./index-81daa372.js";import{u as F}from"./useLifeHandler.hook-37fc3ec5.js";import{u as x,C as le}from"./chartEditStore-45e70a9f.js";import"./SettingItem-2752cac5.js";/* empty css                                                                       */import"./SettingItemBox-ba5c9333.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-bbd36025.js";import"./icon-b66964c1.js";import"./index.esm.min-94a18cbf.js";import"./http-e7ed94fe.js";import"./lodash-b5580029.js";import"./plugin-0e60a394.js";import"./fileTypeEnum-21359a08.js";const j=(e,t)=>({zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}),z=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),H=e=>({display:e.hide?"none":"block"}),K=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},ue=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return s({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)},pe=g({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(c(!0),u(M,null,D(e.groupData.groupList,o=>(c(),u("div",{class:v(["chart-item",a(O)(o.styles.animations)]),key:o.id,style:y(s(s(s(s(s(s({},a(j)(o.attr,e.groupIndex)),a(S)(o.styles)),a(G)(o.styles)),a(H)(o.status)),a(K)(o.preview)),a(P)(o.styles)))},[(c(),h(A(o.chartConfig.chartKey),q({id:o.id,chartConfig:o,themeSetting:e.themeSetting,themeColor:e.themeColor,style:s({},a(z)(o.attr))},B(a(F)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});const de=w(pe,[["__scopeId","data-v-214bf203"]]),_e=g({__name:"index",setup(e){const{initDataPond:t,clearMittDataPondMap:n}=se(),o=x(),i=m(()=>o.editCanvasConfig.chartThemeSetting),p=m(()=>Y(o.editCanvasConfig.chartCustomThemeColorInfo)[o.editCanvasConfig.chartThemeColor]);return n(),X(()=>{t(o.requestGlobalConfig)}),(_,d)=>(c(!0),u(M,null,D(a(o).componentList,(r,l)=>(c(),u("div",{class:v(["chart-item",a(O)(r.styles.animations)]),key:r.id,style:y(s(s(s(s(s(s({},a(j)(r.attr,l)),a(S)(r.styles)),a(G)(r.styles)),a(H)(r.status)),a(K)(r.preview)),a(P)(r.styles)))},[r.isGroup?(c(),h(a(de),{key:0,groupData:r,groupIndex:l,themeSetting:i.value,themeColor:p.value},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(c(),h(A(r.chartConfig.chartKey),q({key:1,id:r.id,chartConfig:r,themeSetting:i.value,themeColor:p.value,style:s({},a(z)(r.attr))},B(a(F)(r))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});const L=w(_e,[["__scopeId","data-v-5807f851"]]),he=e=>{const t=N(!1),n=setInterval(()=>{if(window.$vue.component){clearInterval(n);const o=i=>{window.$vue.component(i.chartConfig.chartKey)||window.$vue.component(i.chartConfig.chartKey,ie(i.chartConfig))};e.componentList.forEach(i=>f(void 0,null,function*(){i.isGroup?i.groupList.forEach(p=>{o(p)}):o(i)})),t.value=!0}},200);return{show:t}},ge=e=>{const t=x();t.requestGlobalConfig=e[le.REQUEST_GLOBAL_CONFIG]},fe=g({__name:"suspenseIndex",setup(e){return f(this,null,function*(){let t,n;[t,n]=Z(()=>R()),yield t,n();const o=x();ee(`预览-${o.editCanvasConfig.projectName}`);const i=m(()=>s(s({},ue(o.editCanvasConfig)),S(o.editCanvasConfig))),p=m(()=>{const l=o.editCanvasConfig.previewScaleType;return l===$.SCROLL_Y||l===$.SCROLL_X});ge(o);const{entityRef:_,previewRef:d}=ce(o),{show:r}=he(o);return(l,Ce)=>(c(),u("div",{class:v(`go-preview ${a(o).editCanvasConfig.previewScaleType}`)},[p.value?(c(),u("div",{key:0,ref_key:"entityRef",ref:_,class:"go-preview-entity"},[te("div",{ref_key:"previewRef",ref:d,class:"go-preview-scale"},[a(r)?(c(),u("div",{key:0,style:y(i.value)},[C(a(L))],4)):T("",!0)],512)],512)):(c(),u("div",{key:1,ref_key:"previewRef",ref:d,class:"go-preview-scale"},[a(r)?(c(),u("div",{key:0,style:y(i.value)},[C(a(L))],4)):T("",!0)],512))],2))})}});const ye=w(fe,[["__scopeId","data-v-e7ba7285"]]),me=g({__name:"index",setup(e){return(t,n)=>(c(),h(ne,null,{default:oe(()=>[C(ye)]),_:1}))}}),qe=g({__name:"wrapper",setup(e){let t=N(Date.now());return[b.JSON,b.CHART_TO_PREVIEW].forEach(n=>{window.opener&&window.opener.addEventListener(n,o=>f(this,null,function*(){const i=yield R();re(ae.GO_CHART_STORAGE_LIST,[I(s({},o.detail),{id:i.id})]),t.value=Date.now()}))}),(n,o)=>(c(),h(me,{key:a(t)}))}});export{qe as default};
