var E=(m,f,l)=>new Promise((v,o)=>{var u=s=>{try{p(l.next(s))}catch(d){o(d)}},w=s=>{try{p(l.throw(s))}catch(d){o(d)}},p=s=>s.done?v(s.value):Promise.resolve(s.value).then(u,w);p((l=l.apply(m,f)).next())});import{d as G,W as B,j as H,aG as z,J as Q,r as n,o as O,D as P,w as t,e,q as U,f as c,t as h,u as a,h as A,b5 as J,l as W,Y,cp as K,cq as X,c as Z,cP as $,a4 as F,bf as ee}from"./index-c6cc3b14.js";import{i as te}from"./icon-8314374d.js";import{S as I}from"./SettingItem-ec2fd044.js";import{S as R}from"./SettingItemBox-cf908047.js";import"./chartEditStore-3ee495ca.js";import{R as ae,a as oe}from"./pondIndex.vue_vue_type_style_index_0_scoped_de860d6d_lang-5e6f8b0d.js";import{u as ne}from"./useTargetData.hook-5f5f1f2c.js";import"./index-fa8f8e54.js";import"./EditorWorker-df02f0e7.js";import"./editorWorker-43a98755.js";import{c as se}from"./http-abbaebe7.js";import{C as le}from"./index-9631b53b.js";/* empty css                                                                       */import"./plugin-0dcb0bd6.js";import"./index-af8cb105.js";import"./fileTypeEnum-21359a08.js";const re={class:"go-pr-3"},ce=G({__name:"index",props:{modelShow:Boolean,targetData:Object,saveBtnText:String||null},emits:["update:modelShow","sendHandle"],setup(m,{emit:f}){const l=m,{chartConfig:v}=B(l.targetData),{requestContentType:o}=B(l.targetData.request),u=H(!1),w={[z.DEFAULT]:"普通请求",[z.SQL]:"SQL 请求"};Q(()=>l.modelShow,s=>{u.value=s},{immediate:!0});const p=()=>{f("update:modelShow",!1),f("sendHandle")};return(s,d)=>{const i=n("n-space"),q=n("n-scrollbar"),b=n("n-text"),C=n("n-tag"),x=n("n-button"),k=n("n-card"),y=n("n-modal");return O(),P(y,{class:"go-chart-data-request",show:u.value,"onUpdate:show":d[0]||(d[0]=g=>u.value=g),"mask-closable":!1,closeOnEsc:!1},{default:t(()=>[e(k,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"1000px",height:"800px"}},{header:t(()=>[]),"header-extra":t(()=>[]),action:t(()=>[e(i,{justify:"space-between"},{default:t(()=>[U("div",null,[e(b,null,{default:t(()=>[c("「 "+h(a(v).categoryName)+" 」",1)]),_:1}),e(b,null,{default:t(()=>[c("—— ")]),_:1}),e(C,{type:"primary",bordered:!1,style:{"border-radius":"5px"}},{default:t(()=>[c(h(w[a(o)]),1)]),_:1})]),e(x,{type:"primary",onClick:p},{default:t(()=>[c(h(m.saveBtnText||"保存 & 发送请求"),1)]),_:1})]),_:1})]),default:t(()=>[e(q,{style:{"max-height":"718px"}},{default:t(()=>[U("div",re,[e(i,{vertical:""},{default:t(()=>{var g;return[e(a(ae)),e(a(oe),{"target-data-request":(g=m.targetData)==null?void 0:g.request},null,8,["target-data-request"])]}),_:1})])]),_:1})]),_:1})]),_:1},8,["show"])}}}),ue=A(ce,[["__scopeId","data-v-6ace1718"]]),de={class:"go-chart-configurations-data-ajax"},ie={class:"go-absolute-center"},pe=G({__name:"index",setup(m){J(_=>({"72bc7361":g.value}));const{HelpOutlineIcon:f,FlashIcon:l,PulseIcon:v}=te.ionicons5,{targetData:o,chartEditStore:u}=ne(),{requestOriginUrl:w,requestInterval:p,requestIntervalUnit:s}=B(u.getRequestGlobalConfig),d=W(),i=H(!1),q=H(!1),b=H(!1);let C=0,x;const k=()=>{q.value=!0},y=()=>E(this,null,function*(){var _;if((_=o.value)!=null&&_.request){i.value=!0;try{const r=yield se(F(o.value.request),F(u.getRequestGlobalConfig));if(i.value=!1,r){const{data:D}=r;!D&&!o.value.filter&&window.$message.warning("您的数据不符合默认格式，请配置过滤器！"),o.value.option.dataset=ee(D,r,o.value.filter),b.value=!0;return}window.$message.warning("没有拿到返回值，请检查接口！")}catch(r){console.error(r),i.value=!1,window.$message.warning("数据异常，请检查参数！")}}}),g=Y(()=>d.getAppTheme);return K(()=>{var r;const _=(r=o.value)==null?void 0:r.filter;x!==_&&C&&(x=_,y()),C++}),X(()=>{x=null}),(_,r)=>{const D=n("n-tag"),S=n("n-input"),T=n("n-icon"),j=n("n-button"),L=n("n-card"),N=n("n-tooltip"),V=n("go-skeleton");return O(),Z("div",de,[e(L,{class:"n-card-shallow"},{default:t(()=>[e(a(R),{name:"请求配置"},{default:t(()=>[e(a(I),{name:"类型"},{default:t(()=>[e(D,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{default:t(()=>[c(h(a(o).request.requestContentType===a(z).DEFAULT?"普通请求":"SQL请求"),1)]),_:1})]),_:1}),e(a(I),{name:"方式"},{default:t(()=>[e(S,{size:"small",placeholder:a(o).request.requestHttpType||"暂无",disabled:!0},null,8,["placeholder"])]),_:1}),e(a(I),{name:"组件间隔"},{default:t(()=>[e(S,{size:"small",placeholder:`${a(o).request.requestInterval||"暂无"}`,disabled:!0},{suffix:t(()=>[c(h(a($)[a(o).request.requestIntervalUnit]),1)]),_:1},8,["placeholder"])]),_:1}),e(a(I),{name:"全局间隔（默认）"},{default:t(()=>[e(S,{size:"small",placeholder:`${a(p)||"暂无"} `,disabled:!0},{suffix:t(()=>[c(h(a($)[a(s)]),1)]),_:1},8,["placeholder"])]),_:1})]),_:1}),e(a(R),{name:"源地址",alone:!0},{default:t(()=>[e(S,{size:"small",placeholder:a(w)||"暂无",disabled:!0},{prefix:t(()=>[e(T,{component:a(v)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),e(a(R),{name:"组件地址",alone:!0},{default:t(()=>[e(S,{size:"small",placeholder:a(o).request.requestUrl||"暂无",disabled:!0},{prefix:t(()=>[e(T,{component:a(l)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),U("div",{class:"edit-text",onClick:k},[U("div",ie,[e(j,{type:"primary",secondary:""},{default:t(()=>[c("编辑配置")]),_:1})])])]),_:1}),e(a(R),{alone:!0},{name:t(()=>[c(" 测试 "),e(N,{trigger:"hover"},{trigger:t(()=>[e(T,{size:"21",depth:3},{default:t(()=>[e(a(f))]),_:1})]),default:t(()=>[c(" 默认赋值给 dataset 字段 ")]),_:1})]),default:t(()=>[e(j,{type:"primary",ghost:"",onClick:y},{icon:t(()=>[e(T,null,{default:t(()=>[e(a(l))]),_:1})]),default:t(()=>[c(" 发送请求 ")]),_:1})]),_:1}),e(a(le),{show:b.value&&!i.value,ajax:!0},null,8,["show"]),e(V,{load:i.value,repeat:3},null,8,["load"]),e(a(ue),{modelShow:q.value,"onUpdate:modelShow":r[0]||(r[0]=M=>q.value=M),targetData:a(o),onSendHandle:y},null,8,["modelShow","targetData"])])}}});const He=A(pe,[["__scopeId","data-v-7cdcb3c8"]]);export{He as default};
